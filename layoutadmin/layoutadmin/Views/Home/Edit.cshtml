
@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>
<html>
<head>
    <title>Update Data</title>
</head>
<body>
    <h1>Update Data</h1>
    <form id="update-form">
        <label for="loaiSanPham">Loại sản phẩm: </label>
        <input type="text" id="loaiSanPham" name="loaiSanPham"><br><br>
        <label for="yeuCauChatLuong">Yêu cầu chất lượng: </label>
        <input type="text" id="yeuCauChatLuong" name="yeuCauChatLuong"><br><br>
        <label for="kinhPhi">Kinh phí: </label>
        <input type="text" id="kinhPhi" name="kinhPhi"><br><br>
        <label for="moTaLoaiSanPham">Mô tả loại sản phẩm: </label>
        <input type="text" id="moTaLoaiSanPham" name="moTaLoaiSanPham"><br><br>
        <button type="submit" id="update-btn">Update</button>
    </form>
    <script>
        // Lấy ID từ URL
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');

        // Tạo yêu cầu GET để lấy dữ liệu hiện tại
        fetch("https://localhost:44364/api/ThanhToanGV/Get-ID?id=" + id)
            .then(response => response.json())
            .then(data => {

                // Điền dữ liệu vào form
                data.forEach(function (item) {
                    document.getElementById('loaiSanPham').value = item.loaiSanPham;
                    document.getElementById('yeuCauChatLuong').value = item.yeuCauChatLuong;
                    document.getElementById('kinhPhi').value = item.kinhPhi;
                    document.getElementById('moTaLoaiSanPham').value = item.moTaLoaiSanPham;
                });
                
            });

        // Tạo yêu cầu PUT khi người dùng bấm vào nút "Update"
        document.getElementById('update-form').addEventListener('submit', event => {

            event.preventDefault();
            const data = {
                id:id,
                loaiSanPham: document.getElementById('loaiSanPham').value,
                yeuCauChatLuong: document.getElementById('yeuCauChatLuong').value,
                kinhPhi: document.getElementById('kinhPhi').value,
                moTaLoaiSanPham: document.getElementById('moTaLoaiSanPham').value,
            };
           fetch("https://localhost:44364/api/ThanhToanGV/Update/" + id, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
                .then(response => {
                    if (response.ok) {
                        alert('Data updated successfully!');
                        // Chuyển trang về danh sách dữ liệu
                        window.location.href = '/Home';
                    } else {
                        alert('Error updating data.');
                    }
                });
        });
    </script>
</body>
</html>


